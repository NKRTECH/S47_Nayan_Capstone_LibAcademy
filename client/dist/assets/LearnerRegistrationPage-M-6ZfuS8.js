import{P,e as E,B as N,b as k,a as G,r as u,u as F,j as e,d as x,a3 as B,f as D}from"./index-CVHsgGyL.js";import{G as I,a as R,S as T}from"./index.esm--ddRR-Sx.js";import{s as m}from"./styled-CpWpjGkL.js";import{C as W}from"./Container-CksAh_Oz.js";import{T as d}from"./TextField-C-8Xz9mF.js";import{A}from"./Alert-6Ca_5wWL.js";import"./mergeSlotProps-CCCx748f.js";import"./Modal-D9nivw5Y.js";import"./useFormControl-D_L_ZpmW.js";import"./createSvgIcon-CRBgYmHc.js";const L="https://s47-nayan-capstone-libacademy.onrender.com/api",q="963011057711-md4pthsv1vv72dport7bp2pgg11rlj8t.apps.googleusercontent.com",O=m(P)(({theme:a})=>({padding:a.spacing(4),marginTop:a.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:a.palette.background.default,boxShadow:a.shadows[5]})),V=m("form")(({theme:a})=>({width:"100%",marginTop:a.spacing(1)})),H=m(E)(({theme:a})=>({margin:a.spacing(3,0,2),background:"linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)",color:a.palette.common.white})),J=m(N)(({theme:a})=>({marginTop:a.spacing(2),width:"100%",display:"flex",justifyContent:"center"})),ee=()=>{const a=k(),p=G(),[t,w]=u.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),{status:g,error:y}=F(r=>r.learner),[b,s]=u.useState(""),[v,n]=u.useState(!1),i=r=>{w({...t,[r.target.name]:r.target.value})},S=r=>{r.preventDefault();const c=r.target;if(c.checkValidity()===!1){c.reportValidity();return}if(t.password!==t.confirmPassword){s("Passwords do not match"),n(!0);return}a(B(t)).then(o=>{o.type==="learner/register/fulfilled"?(p("/learner/"),window.location.reload()):o.type==="learner/register/rejected"&&(s(o.payload),n(!0))}).catch(o=>{console.error("Error registering learner:",o),s(o.message||"Registration failed"),n(!0)})},j=async r=>{var o,h;const{credential:c}=r;try{const l=await D.post(`${L}/learners/register/google`,{credential:c});localStorage.setItem("token",l.data.token),localStorage.setItem("learnerData",JSON.stringify(l.data.learner)),p("/learner/"),window.location.reload()}catch(l){console.error("Error registering with Google OAuth:",l),s(((h=(o=l.response)==null?void 0:o.data)==null?void 0:h.message)||"Google registration failed"),n(!0)}},C=r=>{console.error("Google Sign-In Error:",r),s("Google Sign-In failed"),n(!0)},f=()=>{n(!1)};return e.jsxs(W,{component:"main",maxWidth:"xs",children:[e.jsxs(O,{children:[e.jsx(x,{component:"h1",variant:"h5",children:"Register as a Learner"}),g==="failed"&&e.jsx(x,{color:"error",variant:"body2",align:"center",children:y}),e.jsxs(V,{onSubmit:S,noValidate:!0,children:[e.jsx(d,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"firstName",label:"First Name",name:"firstName",type:"text",autoComplete:"fname",autoFocus:!0,value:t.firstName,onChange:i}),e.jsx(d,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"lastName",label:"Last Name",name:"lastName",type:"text",autoComplete:"lname",value:t.lastName,onChange:i}),e.jsx(d,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",type:"email",autoComplete:"email",value:t.email,onChange:i}),e.jsx(d,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:t.password,onChange:i}),e.jsx(d,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirm Password",type:"password",id:"confirmPassword",autoComplete:"current-password",value:t.confirmPassword,onChange:i}),e.jsx(H,{type:"submit",fullWidth:!0,variant:"contained",disabled:g==="loading",children:"Register"})]}),e.jsx(J,{children:e.jsx(I,{clientId:q,children:e.jsx(R,{onSuccess:j,onFailure:C,scope:"profile email"})})})]}),e.jsx(T,{open:v,autoHideDuration:6e3,onClose:f,children:e.jsx(A,{onClose:f,severity:"error",sx:{width:"100%"},children:b})})]})};export{ee as default};

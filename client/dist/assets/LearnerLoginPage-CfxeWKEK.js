import{P as b,B as j,a as w,u as v,b as C,r as c,j as r,T as k,l as E,c as B}from"./index-FjlUDy0d.js";import{G,a as L,S as T}from"./index.esm-cOXdF-3c.js";import{s as i}from"./styled-BkRJrexq.js";import{C as A}from"./Container-Ckq-t6de.js";import{T as p}from"./TextField-kQOROSC3.js";import{A as F}from"./Alert-BVENnwFH.js";import"./mergeSlotProps-oNhFKx-f.js";import"./Modal-D39q_pmH.js";import"./useFormControl-nniu5AtG.js";import"./createSvgIcon-C4trG8XA.js";const I="https://s47-nayan-capstone-libacademy-7yf9.onrender.com/api",P="963011057711-md4pthsv1vv72dport7bp2pgg11rlj8t.apps.googleusercontent.com",D=i(b)(({theme:e})=>({padding:e.spacing(4),marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:e.palette.background.default,boxShadow:e.shadows[5]})),W=i("form")(({theme:e})=>({width:"100%",marginTop:e.spacing(1)})),O=i(j)(({theme:e})=>({margin:e.spacing(3,0,2),background:"linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)",color:e.palette.common.white})),V=i(w)(({theme:e})=>({marginTop:e.spacing(2),width:"100%",display:"flex",justifyContent:"center"})),K=()=>{const e=v(),d=C(),[l,u]=c.useState({email:"",password:""}),[m,n]=c.useState(!1),[h,s]=c.useState(""),g=a=>{const{name:o,value:t}=a.target;u(S=>({...S,[o]:t}))},f=a=>{a.preventDefault(),console.log("login button clicked");const o=a.target;if(o.checkValidity()===!1){o.reportValidity();return}e(E(l)).then(t=>{t.type==="learner/login/fulfilled"?d("/learner/"):t.type==="learner/login/rejected"&&(s(t.payload),n(!0))}).catch(t=>{console.error("Error logging in:",t),s("An error occurred while logging in."),n(!0)})},x=async a=>{try{const o=await B.post(`${I}/learners/login/google`,{credential:a.credential});localStorage.setItem("token",o.data.token),localStorage.setItem("learnerData",JSON.stringify(o.data.learner)),d("/learner/"),window.location.reload()}catch(o){console.error("Error logging in:",o),s(o.response.data.message),n(!0)}},y=a=>{console.error("Google Sign-In error:",a),s("An error occurred during Google Sign-In."),n(!0)};return r.jsxs(A,{component:"main",maxWidth:"xs",children:[r.jsxs(D,{children:[r.jsx(k,{component:"h1",variant:"h5",children:"Learner Login"}),r.jsxs(W,{onSubmit:f,noValidate:!0,children:[r.jsx(p,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",type:"email",autoComplete:"email",autoFocus:!0,value:l.email,onChange:g}),r.jsx(p,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:l.password,onChange:g}),r.jsx(O,{type:"submit",fullWidth:!0,variant:"contained",children:"Login"})]}),r.jsx(V,{children:r.jsx(G,{clientId:P,children:r.jsx(L,{onSuccess:x,onFailure:y,scope:"profile email"})})})]}),r.jsx(T,{open:m,autoHideDuration:6e3,onClose:()=>n(!1),children:r.jsx(F,{onClose:()=>n(!1),severity:"error",sx:{width:"100%"},children:h})})]})};export{K as default};

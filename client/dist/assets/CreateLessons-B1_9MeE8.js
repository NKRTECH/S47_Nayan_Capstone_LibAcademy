import{s as C,B as S,r,b as w,H as q,e as N,j as e,P as O,T as j,a as b,c as V}from"./index-f7-2eSJk.js";import{C as $}from"./Container-CUuuXKaa.js";import{A as z}from"./Alert-CQZzBUb_.js";import{T as o}from"./TextField-B4aAAyhF.js";import{C as U}from"./CircularProgress-C6SH9T4R.js";import"./styled-Cry4a1KF.js";import"./Modal-DyP9q9P1.js";import"./IconButton-5JQqtBZk.js";import"./useFormControl-N2H_Ek8d.js";const _="https://s47-nayan-capstone-libacademy-7yf9.onrender.com/api",H=C($)(({theme:a})=>({marginTop:a.spacing(4),padding:a.spacing(3),backgroundColor:a.palette.background.paper,borderRadius:a.shape.borderRadius})),J=C(S)(({theme:a})=>({marginTop:a.spacing(2),marginRight:a.spacing(2)})),ae=()=>{const[a,I]=r.useState(""),[d,T]=r.useState(""),[c,L]=r.useState(""),[p,A]=r.useState(""),[n,B]=r.useState(""),[m,D]=r.useState(0),[i,F]=r.useState(null),[g,f]=r.useState(!1),[v,x]=r.useState(null),P=w(),{courseId:l}=q(),W=N(t=>t.tutor.tutorData._id);r.useEffect(()=>{l&&B(l)},[l]);const E=async t=>{var y,h;t.preventDefault(),f(!0),x(null);const R={text:d,media:[{type:"video",alt:c,description:p}]},s=new FormData;s.append("title",a),s.append("content",JSON.stringify(R)),s.append("courseId",n),s.append("videoFile",i),s.append("tutorId",W),s.append("priority",m);try{const u=localStorage.getItem("token"),k=await V.post(`${_}/lessons/create`,s,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${u}`}});console.log("Lesson created successfully: ",k.data),P(`/tutor/courses/${n}/lessons`)}catch(u){x(((h=(y=u.response)==null?void 0:y.data)==null?void 0:h.message)||"An error occurred")}finally{f(!1)}};return e.jsxs(H,{component:O,children:[e.jsx(j,{variant:"h4",gutterBottom:!0,children:"Create Lesson"}),v&&e.jsx(z,{severity:"error",children:v}),e.jsxs("form",{onSubmit:E,encType:"multipart/form-data",children:[e.jsx(o,{label:"Title",variant:"outlined",fullWidth:!0,value:a,onChange:t=>I(t.target.value),margin:"normal",required:!0}),e.jsx(o,{label:"Lesson text",variant:"outlined",fullWidth:!0,multiline:!0,rows:4,value:d,onChange:t=>T(t.target.value),margin:"normal",required:!0}),e.jsx(o,{label:"Alt text for video",variant:"outlined",fullWidth:!0,value:c,onChange:t=>L(t.target.value),margin:"normal"}),e.jsx(o,{label:"Video description",variant:"outlined",fullWidth:!0,multiline:!0,rows:3,value:p,onChange:t=>A(t.target.value),margin:"normal"}),e.jsx(o,{label:"Order of lesson",variant:"outlined",fullWidth:!0,type:"number",value:m,onChange:t=>D(Number(t.target.value)),margin:"normal"}),e.jsx(o,{label:"Course ID",variant:"filled",fullWidth:!0,value:n,margin:"normal",required:!0,InputProps:{readOnly:!0}}),e.jsxs(b,{mt:2,children:[e.jsx("input",{type:"file",onChange:t=>F(t.target.files[0]),accept:"video/*",style:{display:"none"},id:"video-upload"}),e.jsxs("label",{htmlFor:"video-upload",children:[e.jsx(S,{variant:"contained",component:"span",children:"Upload Video"}),i&&e.jsx(j,{variant:"body2",sx:{marginTop:1},children:i.name})]})]}),e.jsx(b,{display:"flex",justifyContent:"flex-start",alignItems:"center",mt:2,children:e.jsx(J,{variant:"contained",color:"primary",type:"submit",disabled:g,children:g?e.jsx(U,{size:24}):"Create Lesson"})})]})]})};export{ae as default};
